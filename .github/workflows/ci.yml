name: Decrypt & Smoke Test
on: [workflow_dispatch, push]

jobs:
  smoke:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
      
      - name: Initialize Phase Synchronization
        env:
          # Use the secret stored in GitHub Settings
          CORE_KEY: ${{ secrets.PDF_PASSPHRASE }} 
        run: |
          chmod +x scripts/bootstrap.sh
          ./scripts/bootstrap.sh
          # Verification: Check if the unencrypted core exists in the cache
          test -f .cache/love-core.pdf && echo "Phase Synchronization: SUCCESS (R=0 State reached)"
